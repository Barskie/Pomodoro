<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
<link rel='stylesheet' href="../style.css">
    
    <nav class="navbar sticky-top row navbar-light bg-light " id="navStyle">
                                <div class="col-12 col-md-3">
                                    <div class="navbar-brand">
                                        <Link to="../timer.html">
                                            <img src="../images/logo.png" alt="Pivot" width="30px" height="100%" id="createMarginLeft"/>
                                            <span id="createMargin">PIVOT</span>
                                        </Link>
                                    </div>
                                </div>
                                <div class="col-12 col-md-5">
                                    <ul class="nav justify-content-center">

                                        <li class="nav-item">
                                            <a href='../timer.html' class="btn" role="button" id="nav_btn" aria-disabled="true"><i id="createMargin" class="fa fa-clock"></i>Timer</a>
                                        </li>
                                        <li className="nav-item">
                                            <a href='../todo/todoList.html' class="btn" role="button" id="nav_btn" aria-disabled="true" ><i id="createMargin" class="fa fa-list-alt"></i>To-Do</a>
                                        </li>
                                        <li className="nav-item">
                                            <a href = '../routine/routines.html'class="btn" role="button" id="nav_btn" aria-disabled="true" ><i id="createMargin" class="fa fa-list"></i>Routines</a>
                                        </li>
                                        <li className="nav-item">
                                            <button  class="btn" role="button" id="nav_btn" aria-disabled="true" onclick = "redirect('/user/googleCalendar.html')" ><i id="createMargin" class="fa fa-calendar"></i>Calendar</button>
                                        </li>
                                        <li className="nav-item">
                                            <a href='../user/faq.html' class="btn" role="button" id="nav_btn" aria-disabled="true" ><i id="createMargin" class="fa fa-question"></i>FAQ</a>
                                        </li>
                                        
                                        <!-- LOGGED IN -->

                <div class="dropdown" id="dropdownLogged">
                    <button id="dropdown" class="btn btn-primary  dropdown-toggle" type="button" data-toggle="dropdown"  aria-expanded="false" style = "text-align: center; border-radius: 100px; border: 1px solid transparent"><i id="userDropDown" class="fa fa-user-circle"></i>
                </button>
                    <ul class="dropdown-menu dropdown-menu-right" id = "loggedIn">
                        <div class = "row">
                            <div class = "col text-center">
                            <i class="fa fa-user-circle" id="loggedInIcons"></i>
                            <h4 class = "text-center mt-3" id="userName">USERNAME</h4>
                                <div class = "row">
                                    <div class = "col-md-6 text-right ">
                                        <span class = "" id="Fname">FirstName</span>
                                    </div>
                                    <div class = "col-md-6 text-left">
                                        <span class = "" id="Lname">LastName</span>
                                    </div>
                                </div>
                            <span id="Email">emailaddress@email.com</span>
                            <hr class = "hrWhite">
                            </div>
                        </div>
                        <div class = "btnLogged">
                            <a class="dropdown-item" id = "loggedInBtns" href="../user/editProfile.html">EDIT PROFILE</a>
                            <a class="dropdown-item" id = "loggedInBtns" href="../user/changePassword.html">CHANGE PASSWORD</a>
                            <a class="dropdown-item" id = "loggedInBtns" href="../user/reports.html">REPORTS</a>
                            <hr class = "hrBlack">
                            <a class="dropdown-item" id = "loggedInBtns" onclick="logout()">LOG-OUT</a>
                        </div>    
                    </ul>
                </div>
                <!-- END OF LOGGED-IN -->
                 <!-- NOT LOGGED IN DROPDOWN  !-->
                
                 <div class="dropdown" id="dropdownGuest">
                    <button id="dropdown" class="btn btn-primary " type="button" data-toggle="dropdown"  aria-expanded="false" style = "text-align: center; border-radius: 100px; border: 1px solid transparent"><i id="userDropDown" class="fa fa-user-circle"></i>
                </button>
                    <ul class="dropdown-menu dropdown-menu-right" id = "notLoggedIn">
                        <a class="dropdown-item" id = "notLoggedInBtns" href="../user/login.html">LOG-IN</a>
                        <a class="dropdown-item" id = "notLoggedInBtns" href="../user/registration.html">SIGN-UP</a>
                        
                    </ul>
                    </div>
</div>
</nav>

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>



</body>
</html>
<script>
    
      var isLogged=true;
     

    function logout(){
        localStorage.removeItem("user_id");
        window.location.href = "http://localhost/pomodoro/user/login.html";
    }
    function redirect(res){
        // window.location.href = res;
        console.log(res)
        

        if(localStorage.getItem('user_id')){
            window.location.href = "http://localhost/pomodoro"+res;
        } else {
            Swal.fire({
                        title: 'LOGIN FIRST!', 
                        confirmButtonColor: "#783937",
                        text: "Before proceeding, log-in or create an account. ",
                        icon: 'success',
                        confirmButtonText: 'OK'
                    }).then(function() {
                        window.location = "http://localhost/pomodoro/user/login.html";
                    });
      
        }
    }


    /*  */
        $(document).ready(function(){
        $(".dropdown-toggle").dropdown();
        console.log(localStorage.getItem('user_id'))

      
        const guestBtns = document.getElementById('dropdownGuest');
        const userBtns = document.getElementById('dropdownLogged');
 
  
            if(localStorage.getItem('user_id')){
                $.ajax({
                type:"POST",
                url: "http://localhost/pomodoro/api/user_info.php",
                dataType: "json",
                data:{
                    user_id: localStorage.getItem('user_id'),
                },
                
                cache:false,
            success: function(dataResult){
                $('#userName').html(dataResult.user_name)
                $('#Fname').html(dataResult.Fname)
                $('#Lname').html(dataResult.Lname)
                $('#Email').html(dataResult.email)
               

                },error:function(err){
            console.log('error')		 
            }
        })
                guestBtns.style.display='none'; 
                userBtns.style.display='block'; 
                console.log('here')
            } else {
                
                guestBtns.style.display='block';
                userBtns.style.display='none'; 
            }
        }) 
       
</script>