<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link rel='stylesheet' href="style.css">
    
</head>
<body>
    <div id="nav-placeholder">
    </div>
<div class = "spotify" >
    <button class="open-btn" onclick="openSpotify()" ><img src="images/spotifyLogo.png" alt="Spotify" width = "30px" height = "100%" ></button>

    <div class="spotify-popup" id="spotifyContainer">
        <div class = "row">
            <div class = "col text-right">
                <button type="button" class="btn" onclick="closeSpotify()" style="width: 50px;  /*! background-color: rgb(0, 0, 0, 0.2); */border-color: transparent;color: white; border-radius: 15px"><i class="fa fa-window-close" id = "toDoDrop" ></i></button>
            </div>
        </div>
        <div class = "row">
            <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/6wObnEPQ63a4kei1sEcMdH?utm_source=generator&theme=0" width="100%" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>
</div>

<section class ="timer">
    <div class="container px-5 py-5 mx-auto">
   
        
        <div class="container d-flex justify-content-around ">
        
            <div class = "button-group mode-buttons" id ="js-mode-buttons">
                <div class = "row">
                    <div class = "col-4">
                        <button
                        data-mode="pomodoro"
                        class = "button active currentSession"
                        id = "js-pomodoro" disabled
                        >POMODORO
                        
                        </button>
                     </div>
                     <div class = "col-4">
                     <button 
                    data-mode="shortBreak"
                    class = "currentSession"
                    id = "js-short-break" disabled>
                        BREAK
                        </button>
                        </div>

                        <div class = "col-4">
                        <button 
                        data-mode="longBreak"
                        class = "currentSession"
                        id = "js-long-break" disabled>
                            LONG BREAK
                            </button>
                        </div>
                        
                    
                </div>
                </div>
            </div>

            <div class="card timers mx-auto" style = "
            background: rgb(120,57,55);
background: linear-gradient(0deg, rgba(120,57,55,1) 0%, rgba(240,223,209,1) 100%);
           box-shadow: none">
                <div class = "row justify-content-md-center text-center ml-auto mr-3 mb-1">
                        <div class = "col ">
                            <div class = "settingsIcon">
                            <i class="fa fa-cog" data-toggle = "modal" data-target = "#settings" id="timerIcons" style="font-size:24px; z-index:9"></i>
                        </div>
                        </div>
                    </div>
                    <div class = "modal fade" id="settings" role="dialog">
                        <div class = "modal-dialog modal-dialog-centered">
                           <div class = "modal-content">
                              <div class = "modal-header text-center d-block  ">
                                 <h4 class="modal-title  d-inline-block">SESSION SETTINGS</h4>
                              </div>
                              <div class = "modal-body">
                                <span class = "text-left">Time per session (minutes): </span>
                                <div class = "row text-center">
                                
                                    <div class = "col-4 mt-4">
                                        <span class = "text-center">POMODORO</span>
                                    </div>
                          
                            
                                <div class = "col-4 mt-4">
                                    <span class = "text-center">SHORT BREAK</span>
                                </div>
                                <div class = "col-4 mt-4">
                                    <span class = "text-center">LONG BREAK</span>
                                </div>
                               
                            </div>
                            <div class = "row text-center">
                                
                                <div class = "col-4 mt-2 mb-4">
                                    <input type = "number" class = "timeRoutine text-center" id = "timeRoutine" value ="" data-id='inputnumber' step="5" min="10" max ="60"></input>
                                </div>
                      
                        
                            <div class = " col-4 mt-2 mb-4">
                                <input type = "number" class = "timeRoutine text-center" id = "timeRoutine1" value ="" step="5" max ="15" min="5"></input>
                            </div>
                            <div class = " col-4 mt-2 mb-4">
                                <input type = "number" class = "timeRoutine text-center" id = "timeRoutine2" value ="" step="5" max ="15" min="5"></input>
                            </div>
                           
                        </div>
                        </div>
                        
                        <div class="modal-footer">
                            
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="saveSessionTime()" id = "modal-save">Save changes</button>
                       </div>
                       
                              </div>
                        </div>
                     </div>
                <div class = "row justify-content-md-center text-center mx-auto">
                    <div class = "col">
                       
                        <div class = "time text-center" id ="js-clock">
                           
                            <span id="js-minutes" style = "font-size: 40px"></span>
                            <span class="separator" style = "font-size: 40px">:</span>
                            <span id="js-seconds" style = "font-size: 40px">00</span>
                        </div>
                        <svg width="500" height="425">
                            <circle id="circle1" cx="250" cy="210" r="200"></circle>
                            <circle id="circle2" cx="250" cy="210" r="200"></circle>
                          </svg>
                        <div>
                           
                            </div>

                 <!-- Start Pause and Skip Buttons !-->
                <div class = "row justify-content-md-center text-center mx-auto">
                    <div class="col">
                    </div>
                    <div class="col">
                        <button class="btn-block"  id = "timerStart_btn">
                            START
                        </button>
                    </div>
                    <div class="col">
                 

                        <button class="btn-block skip_btn" onclick = "skipToPom()" id = "skip_btn" disabled>
                    <i class="fa fa-fast-forward" id = "timerIcons" style="font-size:30px"></i>
                        </button>
                     
                    
                    </div>
                </div>
            </div>          
                  
</div>
</div>
        <!-- Session Name, Rewrite Session Name and Sticky Note !-->
        <div class = "row justify-content-md-center text-center mt-3 mx-auto">
            <div class = "col text-center">
                <span class = "currentSessionName" id="currentSession">
                    Pomodoro name
                </span>  
            </div>
        </div>
        <div class = "row " style = "margin-top: -60px;">
            <div class = "col-md-8"></div>
                <div class = "col-md-4 text-right mx-auto">
                    <button class="btn-block" id = "sessions_btns">
                        <i class="fa fa-pencil-alt" style="font-size:28px" id="indivIcon" data-toggle = "modal" data-target = "#settings1"></i>
                  
                    </button>
                </div>
                <div class = "modal fade " id="settings1" role="dialog">
                    <div class = "modal-dialog modal-dialog-centered">
                        <div class = "modal-content">
                            <div class = "modal-header text-center d-block  ">
                                <h4 class="modal-title  d-inline-block">EDIT SESSION</h4>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close" style = "color: black;"></button>
                            </div>
                            <div class = "modal-body">
                                <div class = "row  justify-content-md-center text-center">
                                    <div class = "col-8 text-center">
                                        <span class = "text-left">Session Name: </span><input onkeyup="onkeyupedit('name')" class ="sessionOnTimerInput" id='nameCurrentSession' type = "text" value="" placeholder="Session #" style="color: black">
                                        <span class = "text-left mt-3">Notes: </span>
                                        <textarea class ="notesTimerInput2" type = "text" onkeyup="onkeyupedit('notes')" id="notesCurrentSession" value="" placeholder="Session #" style="color: black" cols="40" rows="6"></textarea>
                                    </div>
                                </div>
                               
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        <div class = "row justify-content-md-center text-center">
            <hr class="solid" id="hrWhite">
        </div>
                    
        <div class = "row justify-content-md-center text-center mx-auto">
            <div class = "col-8 text-left">
                <div class = "pomSesions" style = "color:white; font-size:20px;">
                    POMODORO SESSIONS:
                </div>
            </div>
            <div class ="col-2 text-right mt-1 mr-3">
                <!-- <i class="fa fa-chevron-circle-down" style="font-size:25px" id="expandIcon2"></i> -->
            </div>
        </div>
        
          
          <!-- Modal -->
          <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <input type="text" id="currentSessionName"/>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-primary" >Save changes</button>
                </div>
              </div>
            </div>
          </div>

        <!-- POMODORO SESSIONS LIST !-->
        <div class = "row justify-content-md-center text-center mx-auto" id="sessionList">
            <!-- <div class="card sessionsList">
                <div class = "card-header sessionHeader">
                        <div class = "row  justify-content-md-center text-center" id ="accordionSession">
                        <div class = "col-8 text-left">
                            <div class = "sessionListName">
                                <input class ="sessionListInput" type = "text" placeholder="Session #1" style="color: black">
                            </div>
                        </div>
                        <div class ="col-2 text-right mt-1">
                            <button class = "moreBtn" id = "collapsible"  data-toggle="collapse" data-target="#sessionCollapse" aria-expanded="true" aria-controls="collapseOne">
                                <i class="fa fa-angle-down" id="sessionIcons"></i>
                            </button>
                            
                        </div>
                    </div>
                </div>
      
                <div id="sessionCollapse" class="collapse" aria-labelledby="headingOne" data-parent="#accordionSession">
                    <div class = "card-body sessionsTimer">
                      <div class = "row text-center">
                        <div class = "notesTimer">
                            <textarea class ="notesTimerInput" type = "text" placeholder="Session #" style="color: black" cols="40" rows="6"></textarea>
                        </div> 
                      </div>
                      <hr>
                      <div class = "row">
                       
                       <div class = "col text-center">
                            <button type="button" class="btn " id = "sessSaveBtn2"><i class="fa fa-trash" id = "trashIcon2"></i> REMOVE</button>
                        </div>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>
             
        
      
        
          
        <!-- ADDING A SESSION !-->
        <div class = "row justify-content-md-center text-center mx-auto">
            <div class = "col">
                <button class="btn-block text-center" id = "addSession_btn" onclick="addSession()">
                         <i class="fa fa-plus-circle" style="font-size:24px; margin-right:10px;" id="indivIcon"></i> ADD A SESSION
                </button>
            </div>
        </div>
        <hr class="solid" style="margin-bottom: 10px" id="hrWhite2">

        <!-- COMPLETED SESSIONS LIST !-->
        <div class = "row justify-content-md-center text-center mx-auto">
            <div class = "col-8 text-left">
                        <div class = "pomSesions" style = "color:white; font-size:20px;">
                            COMPLETED POMODORO SESSIONS:
                        </div>
                        </div>
                        <div class ="col-2 text-right mt-1 mr-3">
                    <!-- <i class="fa fa-chevron-circle-down" style="font-size:25px" id="expandIcon2"></i> -->
            </div>
        </div>
        
        <div class = "row justify-content-md-center text-center mx-auto" id="completed_session">
            <h2>No Completed session yet</h2>
            <!-- <div class="card sessionsList">
                <div class = "card-header">
                        <div class = "row  justify-content-md-center text-center" id ="accordionSessionC">
                        <div class = "col-8 text-left">
                            <div class = "sessionListName">
                                <input class ="sessionListInput" type = "text" placeholder="Session #" style="color: white">
                            </div>
                        </div>
                        <div class ="col-2 text-right mt-1">
                            <button class = "moreBtn" id = "collapsible"  data-toggle="collapse" data-target="#sessionCollapse2" aria-expanded="true" aria-controls="collapseOne">
                                <i class="fa fa-angle-down" id="sessionIcons"></i>
                            </button>
                        </div>
                    </div>
                </div>
      
                <div id="sessionCollapse2" class="collapse" aria-labelledby="headingOne" data-parent="#accordionSessionC">
                    <div class = "card-body sessionsTimer">
                      <div class = "row text-center">
                        <div class = "notesTimer">
                        <textarea class ="notesTimerInput" type = "text" placeholder="Session #" style="color: black" cols="40" rows="6"></textarea>
                    </div>
                      </div>
                      <hr>
                      <div class = "row">
                        <div class = "col text-center">
                            <button type="button" class="btn " id = "sessSaveBtn2"><i class="fa fa-trash" id = "trashIcon2"></i> REMOVE</button>
                      </div>
                      </div>
                    </div>
                </div>
            </div> -->
            
        </div>
        <div class = "row justify-content-md-center text-center mx-auto mt-4 mb-4" id = "spacing"style = "color: white" hidden>
            <div class="card noneComplete">
                    <div class = "row text-center">
                        <div class = "col text-center mt-4 mb-2" id="">
                             NO COMPLETED SESSIONS YET</a>
                        </div>
                        
                    </div>
                </div>
                <div class="card-footer bg-transparent">  
                </div>
            </div>
        


       
        
        <hr class="solid" id="hrWhite2">

        <!-- SAVING ALL AS ROUTINE !-->
        <div class = "row justify-content-md-center text-center mx-auto">
            <div class = "col">
                <button class="btn-block text-center" id = "addSession_btn" data-toggle = "modal" data-target = "#saveRoutine" onclick="assignSession()">
                         <i class="fa fa-save"   style="font-size:24px; margin-right:10px;" id="indivIcon"></i> SAVE ALL AS ROUTINE
                </button>
            </div>
        <!-- SAVE AS ROUTINE MODAL -->
            <div class = "modal fade" id="saveRoutine" role="dialog">
                <div class = "modal-dialog modal-dialog-centered modal-dialog-scrollable">
                   <div class = "modal-content">
                      <div class = "modal-header text-center d-block  ">
                         <h4 class="modal-title  d-inline-block">SAVE ROUTINE?</h4>
                      </div>
                      <div class = "modal-body">
                        <div class = "row text-center">
                            <div class = "col">
                            <div class = "form-group mt-3">
                                <label>ROUTINE NAME: </label>
                                <input type = "text" class="groupedInput form-control" id = "routine_name">
                            </div>
                            </div>
                            </div>
                            <hr>
                        <span class = "text-left">Time per session (minutes): </span>
                        <div class = "row text-center">
                        
                            <div class = "col-4 mt-4">
                                <span class = "text-center">POMODORO</span>
                            </div>
                  
                    
                        <div class = "col-4 mt-4">
                            <span class = "text-center">SHORT BREAK</span>
                        </div>
                        <div class = "col-4 mt-4">
                            <span class = "text-center">LONG BREAK</span>
                        </div>
                       
                    </div>
                    <div class = "row text-center">
                        
                        <div class = "col-4 mt-2 mb-4">
                            <input type = "number" class = "timeRoutine text-center" id = "timeRoutinea" value ="25" data-id='inputnumber' step="5" min="20" max ="60"></input>
                        </div>
              
                
                    <div class = " col-4 mt-2 mb-4">
                        <input type = "number" class = "timeRoutine text-center" id = "timeRoutine1a" value ="05" step="5" max ="15" min="5"></input>
                    </div>
                    <div class = " col-4 mt-2 mb-4">
                        <input type = "number" class = "timeRoutine text-center" id = "timeRoutine2a" value ="05" step="5" max ="15" min="5"></input>
                    </div>
                   
                </div>
                <hr>
                <span class = "text-left mb-3" style = "font-size: 20px;">SESSIONS: </span>
                <div class = "groupedSess" id="forSavingSession">
                    <!-- START OF SESSIONS-->
                    <div class = "row">
                        <div class = "col text-left">
                            <input type="text" class = "taskName" id="todoName" placeholder="Session 1">
                        </div>
                       
                        <hr class = "hrWhite2">
                    </div>
                    <!--END-->

                       
                </div>
                </div>
                
                
                <div class="modal-footer">
                    
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">CANCEL</button>
                    <button type="button" class="btn btn-primary" id = "modal-save" onclick="saveRoutine()">SAVE</button>
               </div>
               
                      </div>
                </div>
             </div>
        </div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="sweetalert2.all.min.js"></script>
    <link rel="stylesheet" href="sweetalert2.min.css">
    <script>
        $.get("navigationBar2.html", function(data){
            $("#nav-placeholder").replaceWith(data);
            });
        </script>

<script>
    
    //variables
    let sessionArray = [{
        name:'pomodoro #1',
        notes:'pomodoro #1',
    },
    {
        name:'pomodoro #2',
        notes:'pomodoro #2'
    }
    ]
    // let noteArray = ['pomodoro #1','pomodoro #2','pomodoro #3']
    window.onbeforeunload = function() {
        if(!localStorage.getItem('user_id')){
        Swal.fire({
                title: 'LOGIN FIRST!', 
                confirmButtonColor: "#783937",
                text: "Before proceeding, log-in or create an account. ",
                icon: 'error',
                confirmButtonText: 'OK'
            }).then(function() {
                window.location = "../user/login.html";
             });
            
        }else {
            return "Data will be lost if you leave the page. Make sure to save the sessions to routines in order to prevent this.";
        };

        }
       



    let completedArray = null

    var pomodoro = 25
    var short_break = 5
    var long_break = 15

    $( document ).ready(function() {
        loadList();
       setTime()
    });
    var clicks = 0;
    function openSpotify() {
      document.getElementById("spotifyContainer").style.display = "block";
      
        if(clicks == 0){
            Swal.fire({
                    title: 'Warning!',
                    text: '"Please make sure to lower the volume before playing!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
            clicks += 1;
        }
     
    }
    function setTime(){
        document.getElementById('timeRoutine').value = pomodoro
        document.getElementById('timeRoutine1').value = short_break
        document.getElementById('timeRoutine2').value = long_break
        document.getElementById('timeRoutinea').value = pomodoro
        document.getElementById('timeRoutine1a').value = short_break
        document.getElementById('timeRoutine2a').value = long_break
    }
    
    function closeSpotify() {
      document.getElementById("spotifyContainer").style.display = "none";
    }

    var reference_index = 0
    //default session
    function loadList(){
    innerHtml = '';
    completedInnerHtml = '';
    var val = 0
        for (let i = 0; i < sessionArray.length; i++) {
            
            if(!sessionArray[i].is_completed && val == 0){
                val = 1
                reference_index = i
                $('#currentSession').html(sessionArray[i].name)
                document.getElementById('nameCurrentSession').value = sessionArray[i].name
                document.getElementById('notesCurrentSession').value = sessionArray[i].notes
                
            }else if(sessionArray[i].is_completed){
                completedInnerHtml +=' <div class="card sessionsList">'
                completedInnerHtml +='<div class = "card-header sessionHeader">'
                completedInnerHtml +='<div class = "row  justify-content-md-center text-center" id ="accordionSession'+i+'">'
                completedInnerHtml +='<div class = "col-8 text-left">'
                completedInnerHtml += '<div class = "sessionListName">'
                completedInnerHtml += '<input class ="sessionListInput" type = "text" onkeyup="editSessionArray(event.target.value,'+i+')" value="'+sessionArray[i].name+'" placeholder="Session #1" style="color: black">'
                completedInnerHtml += '</div>'
                completedInnerHtml += '</div>'
                completedInnerHtml += '<div class ="col-2 text-right mt-1">'
                completedInnerHtml += '<button class = "moreBtn" id = "collapsible'+i+'"  data-toggle="collapse" data-target="#sessionCollapse'+i+'" aria-expanded="true" aria-controls="collapseOne">'
                completedInnerHtml += '<i class="fa fa-angle-down" id="sessionIcons'+i+'"></i>'
                completedInnerHtml += '</button>'
                completedInnerHtml += '</div>'
                completedInnerHtml += '</div>'
                completedInnerHtml += '</div>'
            
                completedInnerHtml +='<div id="sessionCollapse'+i+'" class="collapse" aria-labelledby="headingOne" data-parent="#accordionSession'+i+'">'
                completedInnerHtml +='<div class = "card-body sessionsTimer">'
                completedInnerHtml +='<div class = "row text-center">'
                completedInnerHtml += '<div class = "notesTimer">'
                completedInnerHtml += '<textarea class ="notesTimerInput" type = "text" placeholder="Session #" style="color: black" cols="40" rows="6">'+sessionArray[i].notes+'</textarea>'
                completedInnerHtml += '</div> '
                completedInnerHtml += '</div>'
                completedInnerHtml += '<hr>'
                completedInnerHtml += '<div class = "row">'
                            
                completedInnerHtml += '<div class = "col text-center">'
                completedInnerHtml += '<button type="button" class="btn " id = "sessSaveBtn2" onclick="removeArray('+i+')"><i class="fa fa-trash" id = "trashIcon2"></i> REMOVE</button>'
                completedInnerHtml += '</div>'
                completedInnerHtml +='</div>'
                completedInnerHtml +='</div>'
                completedInnerHtml +='</div>'
                completedInnerHtml +='</div>'

            }else{
                innerHtml +=' <div class="card sessionsList">'
                innerHtml +='<div class = "card-header sessionHeader">'
                innerHtml +='<div class = "row  justify-content-md-center text-center" id ="accordionSession'+i+'">'
                innerHtml +='<div class = "col-8 text-left">'
                innerHtml += '<div class = "sessionListName">'
                innerHtml += '<input class ="sessionListInput" type = "text" onkeyup="editSessionArray(event.target.value,'+i+')" value="'+sessionArray[i].name+'" placeholder="Session #1" style="color: black">'
                innerHtml += '</div>'
                innerHtml += '</div>'
                innerHtml += '<div class ="col-2 text-right mt-1">'
                innerHtml += '<button class = "moreBtn" id = "collapsible'+i+'"  data-toggle="collapse" data-target="#sessionCollapse'+i+'" aria-expanded="true" aria-controls="collapseOne">'
                innerHtml += '<i class="fa fa-angle-down" id="sessionIcons'+i+'"></i>'
                innerHtml += '</button>'
                innerHtml += '</div>'
                innerHtml += '</div>'
                innerHtml += '</div>'
            
                innerHtml +='<div id="sessionCollapse'+i+'" class="collapse" aria-labelledby="headingOne" data-parent="#accordionSession'+i+'">'
                innerHtml +='<div class = "card-body sessionsTimer">'
                innerHtml +='<div class = "row text-center">'
                innerHtml += '<div class = "notesTimer">'
                innerHtml += '<textarea class ="notesTimerInput" type = "text" placeholder="Session #" style="color: black" cols="40" rows="6">'+sessionArray[i].notes+'</textarea>'
                innerHtml += '</div> '
                innerHtml += '</div>'
                innerHtml += '<hr>'
                innerHtml += '<div class = "row">'
                            
                innerHtml += '<div class = "col text-center">'
                innerHtml += '<button type="button" class="btn " id = "sessSaveBtn2" onclick="removeArray('+i+')"><i class="fa fa-trash" id = "trashIcon2"></i> REMOVE</button>'
                innerHtml += '</div>'
                innerHtml +='</div>'
                innerHtml +='</div>'
                innerHtml +='</div>'
                innerHtml +='</div>'
            }
            // console.log('test array')
        }
        
        $('#sessionList').html(innerHtml)
        $('#completed_session').html(completedInnerHtml)
        if(val == 0){
          
           mainButton.disabled=true;
            $('#currentSession').html('No more session')
            stopTimer();
        }
    }

    function saveSessionTime(){
        // pomodoro = 20
        
        pomodoro = document.getElementById('timeRoutine').value
        short_break = document.getElementById('timeRoutine1').value
        long_break = document.getElementById('timeRoutine2').value

        if (pomodoro < 20){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The pomodoro timer cannot be less than 20 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if (pomodoro > 60){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The pomodoro timer cannot exceed 60 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if(short_break < 2){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The short break timer cannot be less than 2 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if(short_break > 5){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The short break timer cannot be more than 5 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if(long_break < 10){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The long break timer cannot be less than 10 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if(long_break > 20){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The long break timer cannot be more than 20 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else{
            timer = {
            pomodoro: pomodoro,
            shortBreak:  short_break,
            longBreak: long_break,
            longBreakInterval: 4,
            sessions: 0,
        }

        setTime()
        switchMode('pomodoro')
        }
        
        updateClock()
    }

    function removeArray(index){
        sessionArray.splice(index, 1)
        loadList();
    }
    function assignSession(){
        innerHtml = ''
        for (let i = 0; i < sessionArray.length; i++) {
            innerHtml +=' <div class = "row">'
            innerHtml +='<div class = "col-12 text-left">'
            innerHtml +='<input type="text" class = "taskName2" value="'+sessionArray[i].name+'" id="todoName" placeholder="Session 1" readonly>'
            innerHtml +='</div>'
            innerHtml +='</div>'
        }
        $('#forSavingSession').html(innerHtml)
    }
    function saveRoutine(){
        pomodoro = document.getElementById('timeRoutinea').value
        short_break = document.getElementById('timeRoutine1a').value
        long_break = document.getElementById('timeRoutine2a').value
        if(!localStorage.getItem('user_id')){
        Swal.fire({
                title: 'LOGIN FIRST!', 
                confirmButtonColor: "#783937",
                text: "Before proceeding, log-in or create an account. ",
                icon: 'error',
                confirmButtonText: 'OK'
            }).then(function() {
                window.location = "http://localhost/pomodoro/user/login.html";
             });
            
            }
        else if (pomodoro < 20){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The pomodoro timer cannot be less than 20 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if (pomodoro > 60){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The pomodoro timer cannot exceed 60 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if(short_break < 2){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The short break timer cannot be less than 2 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if(short_break > 5){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The short break timer cannot be more than 5 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if(long_break < 10){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The long break timer cannot be less than 10 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }
        else if(long_break > 20){
            Swal.fire({
                    title: 'Warning!',
                    text: '"The long break timer cannot be more than 20 minutes!" ',
			        confirmButtonColor: "#783937",
                    icon: 'warning',
                    confirmButtonText: 'OK'
                })
        }    
        else{
                $.ajax({
                type:"POST",
                url: "../api/add_routine.php",
                dataType: "json",
                data:{
                    user_id: localStorage.getItem('user_id'),
                    routine_name: document.getElementById('routine_name').value,
                    pomodoro: pomodoro,
                    short_break: short_break,
                    long_break: long_break,
                    sessionArray: sessionArray
                },
                
                cache:false,
                success: function(dataResult){
                    
                    if(dataResult.status){
                        Swal.fire({
                        title: 'ROUTINE ADDED!', 
                        confirmButtonColor: "#783937",
                        icon: 'success',
                        confirmButtonText: 'OK'
                    }).then(function() {
                        checkAsssessment()
                        window.location.href = 'routine/routines.html'
                    });
                                        
                    }else{
                        alert(dataResult.message)
                    }
                        },error:function(err){
                    console.log('error')		 
                    }
                })
            // console.log('hi')
            }
    }
    function editSessionArray(value,index){
        sessionArray[index].name = value
    }
    function addSession(){
        mainButton.disabled=false;
        sessionArray.push({name:'pomodoro #'+parseInt(sessionArray.length+1),notes:'pomodoro #'+parseInt(sessionArray.length+1)})
        // noteArray.push('pomodoro #'+parseInt(sessionArray.length+1))
        loadList();
    }
    function removeSession(){
        sessionArray
        var routin_name = document.getElementById('routine_name').value
    }
    function is_completed(i){
        sessionArray[i].is_completed = true
        loadList()
    }
    function onkeyupedit(name) {
        sessionArray[reference_index].name = document.getElementById('nameCurrentSession').value
        sessionArray[reference_index].notes = document.getElementById('notesCurrentSession').value
        $('#currentSession').html(sessionArray[reference_index].name)
    }
    function assessCount(){
          
            var getTime = parseInt(localStorage.getItem('pomodoro'))  // 25
            // localStorage.removeItem("assessTime");
        
          ; // 25
             // 25
            if(!localStorage.getItem('assessTime')){
                localStorage.setItem('assessTime', getTime)
            } else {
                var currentTimeAssess = parseInt(localStorage.getItem('assessTime'))
                var updatedTime = currentTimeAssess += getTime;
                localStorage.setItem('assessTime', updatedTime)
            }
           
            console.log(localStorage.getItem('assessTime') + "testing assess")



        }

    // $.ajax({
    //         type:"POST",
    //         url: "http://localhost/pomodoro/api/user_info.php",
    //         dataType: "json",
    //         data:{
    //             user_id: localStorage.getItem('user_id'),
    //         },
            
    //         cache:false,
    //         success: function(dataResult){
    //             $('#userName').html(dataResult.user_name)
    //             $('#Fname').html(dataResult.Fname)
    //             $('#Lname').html(dataResult.Lname)
    //             $('#Email').html(dataResult.email)

    //             },error:function(err){
    //         console.log('error')		 
    //         }
    //     })
    




 </script>
  <script>
    checkAsssessment()

    function checkAsssessment(){
        var dtToday = new Date();
            var month = dtToday.getMonth() + 1;
            var day = dtToday.getDate();
            var year = dtToday.getFullYear();
            var hr = dtToday.getHours();
            var min = dtToday.getMinutes();
            if(month < 10)
                month = '0' + month.toString();
            if(day < 10)
                day = '0' + day.toString();
            var maxDate = year + '-' + month + '-' + day;
            var time = hr + ':' + min;
          
                //sweet alert before assessments
            $.ajax({
                    type:"POST",
                    url: "../api/get_assessment_availability.php",
                    dataType: "json",
                    data:{
                        user_id: localStorage.getItem('user_id'),
                        date: maxDate,
                        time: time
                    },
                    
                    cache:false,
                    success: function(dataResult){
                        if(!dataResult.is_exist){
                            if((localStorage.getItem('assessTime')) >= 2){ //palitan na lang yung 2
                                stopTimer()
                                Swal.fire({
                                    title: 'ASSESSMENT', 
                                    confirmButtonColor: "#783937",
                                    text: "You have been productive for more than one hundred minutes today! Take a moment to answer the Time Management Assessment Questionnaire. ",
                                    icon: 'success',
                                    confirmButtonText: 'OK',
                                    footer: '<a href="privacyPolicy.html" target="_blank">Privacy Policy</a>'
                            }).then((result) => {
                                localStorage.setItem('is_assessment',true)
                                window.location.href = 'user/assessment.html'
                            })}
                        }else{
                            availble_to_assess = false
                            localStorage.removeItem("assessTime");
                            console.log('removedAssessTime')
                        }
                       
                    },error:function(err){
                        console.log('assessment exist')		 
                    }
                })
            

    }
    var timer = {
        pomodoro: pomodoro,
        shortBreak:  short_break,
        longBreak: long_break,
        longBreakInterval: 4,
        sessions: 0,
      };
      
      let interval;
      const circle = document.getElementById('circle2');
      const length = circle.getTotalLength();
       
        circle.style.strokeDasharray = length;
        circle.style.strokeDashoffset = length;
    
    
      var btns = document.getElementsByClassName("currentSession");
      const mainButton = document.getElementById('timerStart_btn');
      const skipBtn = document.getElementById("skip_btn")
      var spacingHide = document.getElementById("spacing")
      
      mainButton.addEventListener('click', () => {
        const { action } = mainButton.dataset;
        if (action === 'START') {
            
          validateUser();
        } else {
           
          stopTimer();
        }
      });
      
      const modeButtons = document.querySelector('#js-mode-buttons');
      
      modeButtons.addEventListener('click', handleMode);
      
      function getRemainingTime(endTime) {
        const currentTime = Date.parse(new Date());
        const difference = endTime - currentTime;
      
        const total = Number.parseInt(difference / 1000, 10);
        const minutes = Number.parseInt((total / 60) % 60, 10);
        const seconds = Number.parseInt(total % 60, 10);
      
        return {
          total,
          minutes,
          seconds,
        };
      }
      
      function validateUser() {
        if(!localStorage.getItem('user_id')){
        Swal.fire({
                title: 'LOGIN FIRST!', 
                confirmButtonColor: "#783937",
                text: "Before proceeding, log-in or create an account. ",
                icon: 'error',
                confirmButtonText: 'OK'
            })
            
            
            .then(function() {
                window.location = "../user/login.html";
             });
            
        } else {
            startTimer()
        }
      }
      
      function startTimer() {
        let { total } = timer.remainingTime;
        const endTime = Date.parse(new Date()) + total * 1000;
        const newEnd =  Number.parseInt(endTime / 1000, 10);
      
        if (timer.mode === 'pomodoro') timer.sessions++;
      
        mainButton.dataset.action = 'STOP';
        mainButton.textContent = 'STOP';
        mainButton.classList.add('active');
      
        
      
        interval = setInterval(function() {
          timer.remainingTime = getRemainingTime(endTime);
          updateClock();
          total = timer.remainingTime.total;
          circle.style.strokeDashoffset = length + (total / 60) * length;
          
          if (total <= 0) {
            clearInterval(interval);
            switch (timer.mode) {
              case 'pomodoro':
                if (timer.sessions % timer.longBreakInterval === 0) {
                  switchMode('longBreak');
                  is_completed(reference_index)
                  mainButton.disabled=true;
                  skipBtn.disabled=false;
                  assessCount()
                } else {
                  switchMode('shortBreak');
                  is_completed(reference_index)
                  mainButton.disabled=true;
                  skipBtn.disabled=false;
                  assessCount()
                }
                break;
              default:
                switchMode('pomodoro');
                mainButton.disabled=false;
                skipBtn.disabled=true;
                
                // move(completed,0)
            }
      
            startTimer();
 
          }
        }, 1000);
      }
      
      function stopTimer() {
        clearInterval(interval);
      
        mainButton.dataset.action = 'START';
        mainButton.textContent = 'START';
        mainButton.classList.remove('active');
      }
      function skipToPom(){
    
    Swal.fire({
                        title: 'SKIP TO POMODORO SESSION?', 
                        confirmButtonColor: "#783937",
                        text: "Are you sure you want to skip the break and proceed to the next session? Don't forget that rest is a must! ",
                        icon: 'warning',
                        confirmButtonText: 'OK'
                    }).then(function() {
                        switchMode('pomodoro');
                        mainButton.disabled=false;
                        skipBtn.disabled=true;
                        stopTimer()
                    
                        clearInterval(interval);
                        updateClock()
                        startTimer()
                    });

    
    
  }
      
      function updateClock() {
        const { remainingTime } = timer;
        const minutes = `${remainingTime.minutes}`.padStart(2, '0');
        const seconds = `${remainingTime.seconds}`.padStart(2, '0');
      
        var min = document.getElementById('js-minutes');
        var sec = document.getElementById('js-seconds');
        
        min.textContent = minutes;
        sec.textContent = seconds;
        const text = timer.mode === 'pomodoro' ? 'Get back to work!' : 'Take a break!';
        document.title = `${minutes}:${seconds} — ${text}`;
      
      }
      
      function switchMode(mode) {
        timer.mode = mode;
        timer.remainingTime = {
          total: timer[mode] * 60,
          minutes: timer[mode],
          seconds: 0,
        };
      
        document
          .querySelectorAll('button[data-mode]')
          .forEach(e => e.classList.remove('active'));
        document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
      
        updateClock();
      }
      
      function handleMode(event) {
        const { mode } = event.target.dataset;
      
        if (!mode) return;
      
        switchMode(mode);
        stopTimer();
      }
      
      document.addEventListener('DOMContentLoaded', () => {
        switchMode('pomodoro');
      });
    
      
    
        </script>
    <!-- <script src="timer.js"></script> -->
    <!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
    
    


</body>
</html>